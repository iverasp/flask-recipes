{% extends "base.html" %}
{% block head %}
<script src="/static/js/jquery.linkify.min.js"></script>
<script>
$(window).on('load', function () {
  $('#sources').linkify();
});
</script>
{% endblock head %}

{% block content %}

<section id="add_recipe">
  <div class="panel panel-default">
   <div class="panel-heading">
     <h4 class="panel-title">
       {{ recipe.name }}
     </h4>
   </div>

   <div class="panel-body">
     <p class="small">Author: {{ recipe.author.username }}</p>
     <p class="small">Created: {{ recipe.date }}</p>
     <p class="small">Edited: {{ recipe.date_edited }}</p>
     <h5>Ingredients</h5>
     <p style="white-space: pre-wrap;">{{ recipe.ingredients }}</p>
     <h5>Instructions</h5>
     <p style="white-space: pre-wrap;">{{ recipe.instructions }}</p>
     {% if recipe.sources %}
     <h5>Sources</h5>
     <p id="sources" style="white-space: pre-wrap;">{{ recipe.sources }}</p>
     {% endif %}
     <h5>Categories</h5>
     {% for cat in recipe.categories %}
     <p>{{ cat.name }}</p>
     {% endfor %}

    {% if current_user.id == recipe.author_id %}
    <div class="btn-group clearfix">
      <a class="btn btn-default pull-right" href="{{ url_for('edit', id=recipe.id)}}" role="button">Edit</a>
    </div>
    {% endif %}

    {% for comment in recipe.comment %}
    <div class="panel panel-default">
      <div class="panel-heading">
        Comment by {{comment.author.username}} on {{comment.date}}
      </div>
      <div class="panel-body">
        {{ comment.comment }}
      </div>
    </div>
    {% endfor %}

    {% if current_user.is_authenticated() %}

    <form role="form" method='post' action=''>
      {{ comment_form.hidden_tag() }}
      <div class="form-group">
        <label for "comment">New comment</label>
        {{ comment_form.comment(type="text",
                                        class="form-control",
                                        rows="4",
                                        placeholder="Comment",
                                        style="resize:vertical",
                                        required=True) }}
      </div>
      <div class="form-group">
        <button type="submit" class="btn btn-default pull-right">Submit</button>
      </div>
    </form>
    {% endif %}

    </div>
  </div>
</section>


{% endblock %}
